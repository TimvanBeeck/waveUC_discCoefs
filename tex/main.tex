%3 May 2012
\documentclass[10pt,reqno]{amsart}

\setlength{\topmargin}{0cm}
\setlength{\textheight}{21cm}
\setlength{\oddsidemargin}{0in}
\setlength{\evensidemargin}{0in}
\setlength{\textwidth}{6.5in}
\setlength{\parindent}{.25in}

\pagestyle{plain}
\usepackage{stmaryrd}
\usepackage{amssymb, amsmath, amsthm}
\usepackage{mathtools}
\usepackage{xcolor}
\usepackage{hyperref}
%\usepackage{showkeys}
\usepackage{enumerate}
\usepackage{subfig}
\usepackage{enumitem} 
\usepackage{todonotes}
\usepackage{booktabs}
\usepackage[]{algorithm2e}
\usepackage[capitalize]{cleveref}
\usepackage{placeins}
\crefname{equation}{}{}
\usepackage{verbatim}
\usepackage{bbm}

%\usepackage{graphicx}
%% expansion of width
\textwidth=15.7cm
\textheight=22.5cm
\parskip=3pt
\parindent=8mm
\oddsidemargin=2mm
\evensidemargin=0mm
\topmargin=-0.5cm
\marginparwidth=1cm
%% definition of theorem-type environments
\newtheorem{thm}{Theorem}[section]
\newtheorem{lem}[thm]{Lemma}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{defn}[thm]{Definition}
\newtheorem{rmk}{Remark}
\newtheorem{exa}{Example}
\newtheorem{assum}{Assumption}
\numberwithin{equation}{section}
\newcommand{\bel}{\begin{equation} \label}
\newcommand{\ee}{\end{equation}}
\def\beq{\begin{equation}}
\def\eeq{\end{equation}}
\newcommand{\jump}[1]{\llbracket#1\rrbracket}
\newcommand{\bea}{\begin{eqnarray}}
\newcommand{\eea}{\end{eqnarray}}
\newcommand{\beas}{\begin{eqnarray*}}
\newcommand{\eeas}{\end{eqnarray*}}
\newcommand{\pd}{\partial}
\newcommand{\mdiv}[1]{\ensuremath{\mathrm{div} \left( #1 \right)}}
\newcommand{\dd}{\mbox{d}}

\newcommand{\ep}{\varepsilon}
\newcommand{\la}{\lambda}
\newcommand{\va}{\varphi}
\newcommand{\ppp}{\partial}
\newcommand{\chch}{\chi_{\eta}}
\newcommand{\walpha}{\widetilde{\alpha}}
\newcommand{\wbeta}{\widetilde{\beta}}

\newcommand{\re}{\mathfrak R}

\newcommand{\im}{\mathfrak I}
\newcommand{\pdif}[2]{\frac{\partial #1}{\partial #2}}
\newcommand{\ppdif}[2]{\frac{\partial^2 #1}{{\partial #2}^2}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}} 
\newcommand{\N}{\mathbb{N}} 
\newcommand{\ooo}{\overline}
\newcommand{\uu}{\mathbf{u}}
\renewcommand{\v}{\mathbf{v}}
\newcommand{\y}{\mathbf{y}}
\newcommand{\RR}{\mathbf{R}}
\newcommand{\Y}{\mathbf{Y}}
\newcommand{\w}{\mathbf{w}}
\newcommand{\z}{\mathbf{z}}
\newcommand{\G}{\mathbf{G}}
\newcommand{\cB}{\mathcal{B}}
\newcommand{\cD}{\mathcal{D}}
\newcommand{\cL}{\mathcal{L}}
\newcommand{\cO}{\mathcal{O}}
\newcommand{\Hin}{\mathcal{H}_{\mathrm{in},T_0}}
\newcommand{\Gi}{S_{\mathrm{in}}}
\newcommand{\Go}{S_{\mathrm{out}}}
\newcommand{\dom}{\mathrm{Dom}}

\newcommand{\sdd}{\mathcal{E}}


\renewcommand{\baselinestretch}{1.5}
%
\renewcommand{\div}{\mathrm{div}\,}  %div
\newcommand{\grad}{\mathrm{grad}\,}  %grad
\newcommand{\rot}{\mathrm{rot}\,}  %rot

\newcommand{\supp}{\mathrm{supp}\,}  %supp
%\newcommand{\span}{\mathrm{span}\,} %span

\allowdisplaybreaks
%%  item
\renewcommand{\theenumi}{\arabic{enumi}}
\renewcommand{\labelenumi}{(\theenumi)}
\renewcommand{\theenumii}{\alph{enumii}}
\renewcommand{\labelenumii}{(\theenumii)}
\def\epsilon{\varepsilon}
%\def\phi {\varphi}
\def \la {{\lambda}}
\def \a {{\alpha}}
\def\t{\theta}
\def\fh{\frac{1}{h}}


\DeclareMathOperator{\dis}{dist}


\newcommand{\wop}{\square_c}

\newcommand{\tnorm}[1]{\vert\hspace{-0.3mm}\Vert#1\Vert\hspace{-0.3mm}\vert}

\providecommand{\abs}[1]{\left\lvert#1\right\rvert}
% pour les normes
\providecommand{\norm}[1]{\left\lVert#1\right\rVert}

\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\providecommand{\abs}[1]{\left\lvert#1\right\rvert}
% pour les normes
\providecommand{\norm}[1]{\left\lVert#1\right\rVert}
\def\thefootnote{{}}



\newcommand{\HOX}[1]{\marginpar{\footnotesize #1}}

\newcommand{\gammaGLS}{\gamma_{\text{GLS}}}
\newcommand{\gammaCIP}{\gamma}

\newcommand{\dT}{\mathrm{d}t}
\newcommand{\dX}{\mathrm{d}x}
\newcommand{\dS}{\mathrm{d}S}

\newcommand{\STdom}{Q}

\newcommand{\STdata}{\omega_T}
\newcommand{\STdataDisc}{\underline{\omega}_T}
\newcommand{\SemiDiscSpace}{\mathcal{W}_h}
\newcommand{\FullyDiscSpace}{W}

%\newcommand{\FullyDiscrSpaceDisc}[2]{ W_{ {#1},{#2}}^{ \text{dc} } }
%\newcommand{\FullyDiscrSpaceCont}[2]{ W_{ {#1},{#2}}^{ \text{c}  } }
%\newcommand{\ProdFullyDiscrSpaceDisc}[2]{  \mathcal{W}_{ {#1},{#2} }^{ \text{dc} } }
%\newcommand{\ProdFullyDiscrSpaceCont}[1]{  \mathcal{W}_{ {#1} }^{ \text{c} } }

\newcommand{\SemiDiscrSpace}[1]{ W^{ {#1}}_{h} }
\newcommand{\ProdSemiDiscrSpace}[1]{ \mathcal{W}^{ {#1} }_{h} }
\newcommand{\FullyDiscrSpace}[2]{ W^{ {#1},{#2}}_{h, \Delta t  } }
\newcommand{\FullyDiscrSpaceHat}[2]{ \hat{W}^{ {#1},{#2}}_{h, \Delta t  } }
\newcommand{\ProdFullyDiscrSpace}[2]{ \mathcal{W}^{ {#1},{#2}}_{h, \Delta t  } }

\DeclarePairedDelimiterX{\inp}[2]{(}{)}{#1, #2}
\newcommand{\tangular}[1]{ \llbracket\kern-0.5ex|#1|\kern-0.5ex\rrbracket} 
%\newcommand{\jump}[1]{\llbracket#1\rrbracket}
\newcommand{\avg}[1]{ \{\!\!\{#1\}\!\!\}}

\newboolean{includeextras}
\ifdefined\withextras
\setboolean{includeextras}{true}
\else
\setboolean{includeextras}{false}
\fi

\newcommand{\putextra}[1]{\ifthenelse{\boolean{includeextras}}{#1}{}}

\newcommand{\Uh}{\underline{\mathbf{U}}_h}
\newcommand{\Yh}{\underline{\mathbf{Y}}_h}
\newcommand{\Zh}{\underline{\mathbf{Z}}_h}
\newcommand{\Wh}{\underline{\mathbf{W}}_h}

\newcommand{\ul}{\underline{u}}
\newcommand{\yl}{\underline{y}}
\newcommand{\zl}{\underline{z}}
\newcommand{\wl}{\underline{w}}

\newcommand{\Sud}{S^{\uparrow \downarrow}_{\Delta t}}


\newcommand{\dt}{\partial_t}
\newcommand{\dtt}{\partial_t^2}

%%% TvB: Added for plots, some might be redundant ##

%------------------------- Added for Plots ----
% Tikz package
\usepackage{tikz}
\usepackage{pgfplots,pgfplotstable}
\usepgfplotslibrary{colorbrewer,groupplots}
\usepackage{caption}
\pgfplotsset{compat=1.18}

\pgfplotsset{
% initialize Set1-5:
cycle list/Set1-5,
% combine it with ’mark list*’:
cycle multiindex* list={
mark list*\nextlist
Set1-5\nextlist
},
}

\pgfplotsset{
    discard if not/.style 2 args={
        x filter/.append code={
            \edef\tempa{\thisrow{#1}}
            \edef\tempb{#2}
            \ifx\tempa\tempb
            \else
                \def\pgfmathresult{inf}
            \fi
        }
    }
}

%%%


\title{Data assimilation for the wave equation with discontinuous coefficients}
\author{Erik Burman, Janosch Preuss and Tim van Beeck}

\date{\today}
\begin{document}
\maketitle

\section{Introduction}
\noindent Let $\Omega \subset \mathbb{R}^d$ be a bounded domain such that there exists subdomains $\Omega_1, \Omega_2 \subseteq \Omega$ such that $\Omega = \overline{\Omega}_1 \cup \overline{\Omega}_2$ and $\Omega_1 \cap \Omega_2 = \emptyset$. We consider a scalar wave speed $c(x) = \mathbbm{1}_{\Omega_1} c_1(x) + \mathbbm{1}_{\Omega_2} c_2(x)$, $c_i \in C^\infty(\Omega_i)$, $i = 1,2$, which may be discontinuous across the interface $\Gamma = \Omega \setminus (\Omega_1 \cup \Omega_2)$, but constant in time.  
\noindent In this article, we consider the following problem: find $u \in Q \rightarrow \mathbb{R}$ such that 
\begin{subequations}
    \begin{alignat}{2}
        (\wop u, u) &= (0,0) \quad &&\text{ in } Q \times \Sigma, \label{eq:waveEquation} \\ 
        u &= u_{\omega} &&\text{ in } \omega_T, \\ \label{eq:DataMatch}
    \end{alignat}    
\end{subequations}
where $\wop u := \partial_t^2 - \div(c(x)^2 \nabla u)$ is the wave operator and $u_{\omega}$ is the known data. 

\noindent The continuous problem has been studied in \cite{Filippas22}. In particular, the following result has been shown:
\begin{thm}[Thm. 1.1 of \cite{Filippas22}]\label{thm:filippas}
    For any nonempty subset $\omega \subset \Omega$ and $T > \text{dist}(\Omega,\omega)$, there exists $C,\kappa,\mu_0$ such that for any initial data $(u_0,u_1) \in H^1_0(\Omega) \times L^2(\Omega)$ and $u$ solving... one has for any $\mu \ge \mu_0$ that 
    \begin{equation}
        \Vert (u_0,u_1) \Vert_{L^2 \times H^{-1}} \le C e^{\kappa \mu} \Vert u \Vert_{L^2(\omega_T)} + \frac{C}{\mu} \Vert (u_0,u_1) \Vert_{H^1 \times L^2}. 
    \end{equation}
\end{thm}

\section{Discretization (fully discrete \& dG in time)} 
\noindent We introduce a similar scheme as considered in \cite{BP24}, but we incoporate the wave speed $c$. \textbf{spaces, etc..} \\
Let $\mathcal{T}_h$ be a quasi-uniform triangulation of $\Omega$ such that both, the data domain $\omega$ and the interface $\Gamma$ are fitted. We define the $H^1$-conforming finite element space 
\begin{equation}
    V_h^k := \{ v \in H^1(\Omega) : v \vert_{K} \in \mathcal{P}^k(K) \ \forall K \in \mathcal{T}_h \},
\end{equation}
where $\mathcal{P}^k(K)$ denotes the space of polynomials of degree at most $k \in \mathbb{N}$ on $K \in \mathcal{T}_h$. Furthermore, we partition the time axis into $N$ subinterals $I_n = (t_n,t_{n+1})$, $n = 0, \dots, N-1$, where $0 = t_0 \le t_1 \le \dots \le t_N = T$. We assume that the interavals are of equal length and denote $\Delta t = \vert t_{n+1} -t_n \vert$. Consequently, we can define a corresponding partition of $Q$ and $\Sigma$ into time-slabs 
\begin{equation}
    Q^n := I_n \times \Omega, \quad \Sigma^n := I_n \times \Sigma, n = 0, \dots, N-1, \qquad Q = \bigcup_{n = 0}^{N-1} Q^n, \quad \Sigma = \bigcup_{n = 0}^{N-1} \Sigma^n.
\end{equation}
In the following, we denote the space-time integrals on the time slabs as 
\begin{equation*}
    (u,v)_{Q^n} := \int_{I_n} \int_{\Omega} uv \ \dX \dT, a(u,v)_{Q^n} := \int_{I_n} \int_{\Omega} c(x)^2 \nabla u \cdot \nabla v \ \dX \dT, \quad (u,v)_{\Sigma^n} := \int_{I_n} \int_{\Sigma} uv \ \dS \dT,
\end{equation*}
and define $\Vert v \Vert^2_{Q^n} := (v,v)_{Q^n}$ and $\Vert v \Vert^2_{\Sigma^n} := (v,v)_{\Sigma^n}$. Furthermore, we set 
\begin{equation*}
    \omega^n := I_n \times \omega, \quad (u,v)_{\omega^n} := \int_{I_n} \int_{\omega} uv \ \dX \dT, \quad \Vert v \Vert^2_{\omega_T} := \sum_{n = 0}^{N-1} (v,v)_{\omega^n}.
\end{equation*}
Finally, we define the time jump operator 
\begin{equation*}
    v^n_{\pm} (x) := \lim_{s \rightarrow 0^+} v(x,t_n \pm s), \quad \jump{v^n} := v^n_+ - v^n_-. 
\end{equation*}


\noindent We define the discontinuous in time finite element spaces 
\begin{equation}
    \FullyDiscrSpace{k}{q} := \otimes_{n = 0}^{N-1} \mathcal{P}^q(I_n) \otimes V_h^k, \quad \ProdFullyDiscrSpace{k}{q} :=  \FullyDiscrSpace{k}{q} \times \FullyDiscrSpace{k}{q}, q \in \mathbb{N}_0, k \in \mathbb{N}. 
\end{equation}

We introduce the bilinear form 
\begin{equation}
    A[\Uh,\Yh] := \sum_{n = 0}^{N -1} \left\{ (\dt \ul_2, \yl_1)_{Q^n} + a(\ul_1,\yl_1)_{Q^n} + (\dt \ul_1 - \ul_2,\yl_2)_{Q^n} - (c(x)^2 \nabla \ul_1 \cdot \mathbf{n}, \yl_1)_{\Sigma^n} \right\}
\end{equation} 
and the Lagrangian 
\begin{align*}
    \cL_h (\Uh, \Zh) := \frac{1}{2} \Vert \ul_1 - u_{\omega} \Vert^2_{\omega_T} + A[\Uh,\Zh] + \frac{1}{2} \gamma S_h(\Uh,\Uh) - \frac{1}{2} \gamma^\ast S_h^\ast(\Zh,\Zh) + \frac{\gamma}{2} \Sud(\Uh,\Uh).
\end{align*}
To define the stabilization terms $S_h$ and $S_h^\ast$, we introduce the following terms: 
\begin{align*}
    J(\Uh,\Wh) &:= \sum_{n = 0}^{N -1} \int_{I_n} \sum_{F \in \mathcal{F}_i} h (\jump{c(x)^2 \nabla \ul_1}, \jump{c(x)^2 \nabla \wl_1})_F \ \dT, \\
    I_0(\Uh,\Wh) &:= \sum_{n = 0}^{N -1} (\ul_2 - \dt \ul_1, \wl_2-\dt \wl_1)_{Q_n}, \\
    G(\Uh,\Wh) &:= \sum_{n = 0}^{N -1} \int_{I_n} \sum_{K \in \mathcal{T}_h} h^2 (\dt \ul_2 - \div (c(x)^2 \nabla \ul_1),\dt \wl_2 -\div( c(x)^2 \nabla \wl_1))_K \ \dT, \\
    R(\Uh,\Wh) &:= \sum_{n = 0}^{N -1} h^{-1} (\ul_1,\wl_1)_{\Sigma^n}. 
\end{align*}
Then, we define the primal stabilizer as 
\begin{equation}
    S_h(\Uh,\Wh) := J(\Uh,\Wh) + I_0(\Uh,\Wh) + G(\Uh,\Wh) + R(\Uh,\Wh), 
\end{equation}
and the dual stabilizer through 
\begin{equation}
    S_h^\ast(\Yh,\Zh) := \sum_{n = 0}^{N-1} \left\{ (\yl_1,\zl_1)_{Q^n} + a(\yl_1,\zl_1)_{Q^n} + (\yl_2,\zl_2)_{Q^n} + h^{-1} (\yl_1,\zl_1)_{\Sigma^n} \right\}.
\end{equation}
The stabilization term $\Sud$ imposes regularity on the discontinuities in time and is defined as 
\begin{equation}
    \Sud (\Uh,\Wh) := \underline{I}_1^{\uparrow \downarrow}(\Uh,\Wh) + \underline{I}_2^{\uparrow \downarrow}(\Uh,\Wh),
\end{equation}
where 
\begin{align*}
    \underline{I}_1^{\uparrow \downarrow}(\Uh,\Wh) &:= \sum_{n = 0}^{N-1} \left\{ \frac{1}{\Delta t} (\jump{\ul_1^n},\jump{\wl_1^n})_{\Omega} + \Delta t (c(x)^2 \jump{\nabla \ul_1^n},c(x)^2 \jump{\nabla \wl_1^n})_{\Omega}\right\}, \\
    \underline{I}_2^{\uparrow \downarrow}(\Uh,\Wh) &:= \sum_{n = 0}^{N-1} \frac{1}{\Delta t} (\jump{\ul_2^n},\jump{\wl_2^n})_{\Omega}.
\end{align*}

\noindent The first order optimality conditions then take the form: Find $(\Uh,\Zh) \in \ProdFullyDiscrSpace{k}{q} \times \ProdFullyDiscrSpace{k^\ast}{q^\ast}$ such that 
\begin{alignat*}{2}
    (\ul_1,\wl_1)_{\omega_T} + A[\Wh,\Zh] + \gamma S_h(\Uh,\Wh) + \Sud(\Uh,\Wh) &= (u_{\omega},\wl_1)_{\omega_T} \quad &&\forall \Wh \in \ProdFullyDiscrSpace{k}{q} \\
    A[\Uh,\Yh] - \gamma^{\ast} S_h^\ast(\Yh,\Zh) &= 0 \quad &&\forall \Yh \in \ProdFullyDiscrSpace{k^\ast}{q^\ast} 
\end{alignat*}
For convenience, we introduce
\begin{equation}
    \begin{aligned}
        B[(\Uh,\Zh),(\Wh,\Yh)] := &(\ul_1,\wl_1)_{\omega_T} + A[\Wh,\Zh]+ \gamma S_h(\Uh,\Wh) \\
        &+  \Sud(\Uh,\Wh) + A[\Uh,\Yh] - \gamma^{\ast} S_h^\ast(\Yh,\Zh),
    \end{aligned}
\end{equation}
such that the first order optimality conditions can be written as: Find $(\Uh,\Zh) \in \ProdFullyDiscrSpace{k}{q} \times \ProdFullyDiscrSpace{k^\ast}{q^\ast}$ such that
\begin{equation}\label{eq:discreteProblem}
    B[(\Uh,\Zh),(\Wh,\Yh)] = (u_{\omega},\wl_1)_{\omega_T} \quad \forall (\Wh,\Yh) \in \ProdFullyDiscrSpace{k}{q} \times \ProdFullyDiscrSpace{k^\ast}{q^\ast}.
\end{equation}


\section{Analysis}
\noindent We define the norms \textbf{has to be shown that they are indeed norms!} 
\begin{equation}
    \tnorm{ (\Uh,\Zh) }^2 := \gamma \vert \Uh \vert^2_{S_h} + \vert \Uh \vert^2_{\uparrow \downarrow} + \Vert \ul_1 \Vert^2_{\omega_T} + \gamma^{\ast} \Vert \Zh \Vert^2_{S_h^\ast},
\end{equation}
where $\vert \cdot \vert_{S_h}, \vert \cdot \vert_{\uparrow \downarrow}$, and $\Vert \cdot \Vert_{S_h^{\ast}}$ are the semi-norms, respectively norms, induced by the stabilizers $S_h$, $\Sud$, and $S_h^{\ast}$:
\begin{equation}
    \vert \Uh \vert^2_{S_h} := S_h(\Uh,\Uh), \quad \vert \Uh \vert^2_{\uparrow \downarrow} := \Sud(\Uh,\Uh), \quad \Vert \Zh \Vert^2_{S_h^{\ast}} := S_h^{\ast}(\Zh,\Zh).
\end{equation}

We modify the steps from \cite{BP24} to show that $\tnorm{(\cdot,\cdot)}$ is indeed a norm. 

\begin{lem}
    The expression $\tnorm{(\cdot,\cdot)}$ is a norm on $\ProdFullyDiscrSpace{k}{q} \times \ProdFullyDiscrSpace{k^\ast}{q^\ast}$.  
\end{lem}

\begin{proof}
    It suffices to show that $\tnorm{(\Uh,\Zh)} = 0$ implies that $\Uh=\Zh= 0$. We first note that $\vert \Uh \vert_{\uparrow \downarrow} = 0$ immediately implies that $(\ul_1,\ul_2) \in [H^1(Q)]^2$. Furthermore, by definition of $\tnorm{(\cdot,\cdot)}$ and definition the stabilization terms $S_h$ and $S_h^{\ast}$, we have that $\Zh = 0$, $\ul_1 \vert_{\Sigma} = 0$, $\ul_1 \vert_{\omega_T} = 0$ and $\dt \ul_1 = \ul_2$. Similar to \cite[Lem. 2.1]{BP24}, we have with partial integration that 
    \begin{align*}
        \Vert \wop \ul_1 \Vert^2_{H^{-1}(Q)} &:= \sup_{\substack{  y \in H^1_0(Q), \\ \norm{y}_{H^1(Q) } = 1  }} \int_{Q} \left\{ -(\dt \ul_1) \dt y + c(x)^2 \nabla \ul_1 \nabla y \right\}  \\
        &= \sup_{\substack{  y \in H^1_0(Q), \\ \norm{y}_{H^1(Q) } = 1  }} \Big\{ \sum_{n = 0}^{N-1} (\ul_2 - \dt \ul_1, \dt y)_{Q_n} + \sum_{n = 0}^{N-1} \int_{I_n} \sum_{K \in \mathcal{T}_h} (\dt \ul_2 - \div(c(x)^2 \nabla \ul_1),y)_{K} \ \dT \\
        &\qquad + \sum_{n = 0}^{N-1} \int_{I_n} \sum_{F \in \mathcal{F}_i} (\jump{c(x)^2 \nabla \ul_1}, y)_F \ \dT + \sum_{n = 0}^{N-1} (\jump{\ul_1^n},y)_{\Sigma^n} \Big\}.
    \end{align*}
    Thus it follows by definition of the stabilizers and $\tnorm{(\Uh,\Zh)} = 0$ that $\Vert \wop \ul_1 \Vert_{H^{-1}(Q)} = 0$. It directly follows from \ref{thm:filippas} that the initial data are zero. {\color{gray} Thats means that $\ul_1$ solves the wave equation with rhs zero, zero initial data, is zero on the boundary and zero on $\omega$... should enough to say that $\ul_1 = 0$ everywhere!?}
\end{proof}

\noindent Since $B[(\Uh,\Zh),(\Uh,-\Zh)] = \tnorm{(\Uh,\Zh)}\tnorm{(\Uh,-\Zh)}$, the inf-sup stability of $B$ on $\ProdFullyDiscrSpace{k}{q} \times \ProdFullyDiscrSpace{k^\ast}{q^\ast}$ is a direct consequence of the previous lemma, i.e. there exists a constant $C>0$ such that 
\begin{equation}
    \sup_{(\Wh,\Yh) \in \ProdFullyDiscrSpace{k}{q} \times \ProdFullyDiscrSpace{k^\ast}{q^\ast}} \frac{B[(\Uh,\Zh),(\Wh,\Yh)]}{\tnorm{(\Wh,\Yh)}} \ge C \tnorm{(\Uh,\Zh)}.
\end{equation}


\begin{lem}[Continuity of $A$]
    \begin{enumerate}
        \item For $\Uh \in \ProdFullyDiscrSpace{k}{q}$ and $\mathbf{Y} \in ...$ we have that 
        \begin{equation}
            A[(\Uh,\mathbf{Y})] \le C ... 
        \end{equation}
        \item For $\mathbf{U} \vert_{Q^n} \in ...$ for all $n = 0, \dots, N-1$ and $\Yh \in \ProdFullyDiscrSpace{k^\ast}{q^\ast}$ we have that
        \begin{equation}
            A[(\mathbf{U},\Yh)] \le C ...
        \end{equation}
    \end{enumerate}
\end{lem}

We recall the following interpolation result from \cite{BP24}: 

\begin{lem}[Lem. 2.4 of \cite{BP24}]\label{lem:interpolationOperator}
    Assume that $\Delta t = Ch$ and set $(s,m) = (\min\{k,q\}, \max\{k,q\}+3)$.
    Then, there exists an interpolation operator $\Pi_h$ into $\FullyDiscrSpace{k}{q}$ such that for $n = 0, \dots, N-1$ the following estimates hold
    \begin{enumerate}
        \item $\sum_{n = 0}^{N-1} \{ h^{-1} \Vert u - \Pi_h u \Vert_{L^2(Q^n)} + \Vert \nabla(u - \Pi_h u) \Vert_{L^2(Q^n)} \} \le C \Vert u \Vert_{H^1(Q)}$. 
        \item $\sum_{n = 0}^{N-1} \{ h^{-1} \Vert u - \Pi_h u \Vert_{L^2(Q^n)} + \Vert u - \Pi_h u \Vert_{H^1(Q^n)} \} \le C h^{s} \Vert u \Vert_{H^{m-1}(Q)}$.
        \item $\left( \sum_{n = 0}^{N-1} \int_{I_n} \sum_{K \in \mathcal{T}_h} h^2 \Vert u - \Pi_h u \Vert^2_{H^2(K)} \ \dT \right)^{1/2} \le C h^{s} \Vert u \Vert_{H^{m}(Q)}$ for $u \in H^m(Q_n) \cap C^0(I_n,H^2(\Omega))$.
    \end{enumerate}
\end{lem}



\begin{lem}[Similar to Lem. 2.5 \& Lem. 4.2 of \cite{BP24}]
    In addition to the assumptions of Lem. \ref{lem:interpolationOperator}, let $u \in H^m(Q)$ solve \eqref{eq:waveEquation} and set $\mathbf{U} = (u,\partial_t u)$. Then, the following estimates hold true. 
    \begin{enumerate}
        \item For $u \in H^m(Q) \cap C^0([0,2],H^2(\Omega))$ we have that 
        \begin{equation}
            \vert \mathbf{\Pi}_h \mathbf{U} \vert_{S_h} = \vert \mathbf{\Pi}_h \mathbf{U} - \mathbf{U} \vert_{S_h} \le C h^{s} \Vert u \Vert_{H^m(Q)}.
        \end{equation}
        \item For $u \in H^m(Q)$ we have that
        \begin{equation}
            \vert \mathbf{\Pi}_h \mathbf{U} \vert_{\uparrow \downarrow} \le C h^{s} \Vert u \Vert_{H^{m-1}(Q)}.
        \end{equation}
        \item For $\Uh \in \ProdFullyDiscrSpace{k}{q}$ it holds that 
        \begin{equation}
            \Vert u - \ul_1 \Vert_{\Sigma} + \Vert u - \ul_1 \Vert_{\omega_T} \le C \left( h^{s+1/2} \Vert u \Vert_{H^m(Q)} + \tnorm{(\Uh - \mathbf{\Pi}_h \Uh,0)} \right).
        \end{equation}
        \item For $\mathbf{Y} = (y_1,y_2) \in [H^1(Q)]^2$, we have that
        \begin{equation}
            \Vert \mathbf{\Pi}^\ast_h \mathbf{Y} \Vert_{S_h^\ast} \le C \left( \Vert y_1 \Vert_{H^1(Q)} + \Vert y_2 \Vert_{H^2(Q)} \right). 
        \end{equation}
    \end{enumerate}
\end{lem}

\begin{proof}
    has to be adpated to the current setting.
\end{proof}


\begin{lem}\label{eq:lemma:stability}
    Let $u$ be a solution of \eqref{eq:waveEquation} and $\mathbf{U} = (u,\partial_t u)$. For any $(\Wh,\Yh) \in \ProdFullyDiscrSpace{k}{q} \times \ProdFullyDiscrSpace{k^\ast}{q^\ast}$ it holds that
    \begin{equation*}
        (u - \Pi_h u, \wl_1)_{\omega_T} - \gamma S_h(\mathbf{\Pi}_h \mathbf{U},\Wh) - A[\mathbf{\Pi}_h \mathbf{U},\Yh] - \Sud(\mathbf{\Pi}_h \mathbf{U}, \Wh) \le C h^s \Vert u \Vert_{H^m(Q)} \tnorm{(\Wh,\Yh)}.
    \end{equation*}
\end{lem}

\begin{proof}
    We follow the proof of \cite[Lem. 2.6]{BP24}. 
\end{proof}


\begin{thm}
    Let $u$ be a sufficient regular solution of \eqref{eq:waveEquation} and $(\Uh,\Zh) \in \ProdFullyDiscrSpace{k}{q} \times \ProdFullyDiscrSpace{k^\ast}{q^\ast}$ be the solution to \eqref{eq:discreteProblem}. Set $\mathbf{U} := (u,\partial_t u)$. Then, there exists a constant $C>0$ such that
    \begin{equation}
        \tnorm{(\Uh - \mathbf{\Pi}_h \mathbf{U},\Zh)} \le C \inf_{...} ... 
    \end{equation}
\end{thm}

\begin{proof}
    The inf-sup condition on $B$ implies that 
    \begin{equation*}
        \tnorm{(\Uh - \mathbf{\Pi}_h \mathbf{U},\Zh)} \le C \sup_{(\Wh,\Yh) \in \ProdFullyDiscrSpace{k}{q} \times \ProdFullyDiscrSpace{k^\ast}{q^\ast}} \frac{B[(\Uh - \mathbf{\Pi}_h \mathbf{U},\Zh),(\Wh,\Yh)]}{\tnorm{(\Wh,\Yh)}}.
    \end{equation*}
    Furthermore, we have that 
    \begin{equation*}
        B[(\Uh - \mathbf{\Pi}_h \mathbf{U},\Zh),(\Wh,\Yh)] = (u - \Pi_h u, \wl_1)_{\omega_T} - \gamma S_h(\mathbf{\Pi}_h \mathbf{U},\Wh) - A[\mathbf{\Pi}_h \mathbf{U},\Yh] - \Sud(\mathbf{\Pi}_h \mathbf{U}, \Wh).
    \end{equation*}
    Hence the claim follows with Lemma \ref{eq:lemma:stability}. 
\end{proof}

\section{Numerical experiments}
\noindent We choose the domain $\Omega = [0,1]$ which is partitioned into the subdomains $\Omega_1 = (0,0.5)$ and $\Omega_2 = (0.5,1.0)$ such that $\Omega = \overline{\Omega}_1 \cup \overline{\Omega}_2$. Then, we fix the wavespeed $c_2 := c \vert_{\Omega_2} = 1$ and consider different values for $c_1 := c \vert_{\Omega_1}$.

\subsection{Example in one space dimension}
As a first example, we consider the exact solution
\begin{equation}\label{eq:1D:exact:simple}
    u(x,t) := \begin{cases}
        \cos(w_1 c_1 t) \cos(w_1(x-0.5)), & x \in \Omega_1, \\
        \cos(w_2 c_2 t) \cos(w_2(x-0.5)), & x \in \Omega_2,
    \end{cases}
\end{equation}
where we set $w_1 = 3 \pi$ and $w_2 = w_1 c_1 / c_2$. We compute until $T = 1.0$ to ensure that the GCC is fulfilled. 


\begin{figure}[!htbp]
    \begin{center}
        \begin{tikzpicture}[scale=0.72]
            \begin{groupplot}[%
                group style={%
                group size=2 by 1,
                horizontal sep=1.5cm,
                vertical sep=2cm,
                },
            ymajorgrids=true,
            grid style=dashed,
            %ymin = 1e-3, ymax = 0.5e1,
            ]    
                \nextgroupplot[width=9cm,height=7cm,domain=0:1,xmode=linear,ymode=linear, xlabel={}, ylabel={}, title={$u$ vs. $u_h$ ($k = 3$)}, %cycle list name=paulcolors, 
                legend pos=north west, %yticklabels={,,},
                ]
                %\addplot+[discard if not={contrast}{1.0},line width=2.5pt,mark=None,color=black] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/exact_plot_data.csv};
                \addplot+[discard if not={L}{1},line width=1.1pt,mark=None] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_approx_plot_data_WPFalse_contrast2.5_k3.csv};
                \addplot+[discard if not={L}{2},line width=1.1pt,mark=None] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_approx_plot_data_WPFalse_contrast2.5_k3.csv};
                \addplot+[discard if not={L}{3},line width=1.1pt,mark=None] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_approx_plot_data_WPFalse_contrast2.5_k3.csv};
                \addplot+[discard if not={L}{4},line width=1.1pt,mark=None] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_approx_plot_data_WPFalse_contrast2.5_k3.csv};
                \addplot+[discard if not={contrast}{2.5},line width=1.1pt,mark=None,color=black] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/exact_plot_data_1D_simple.csv};
                

                \draw[dashed,gray,very thick] (0.5,-2) -- (0.5,2);
                \node [draw=none] at (axis description cs:0.45,0.23) {\color{gray} $\Gamma$};

                \legend{$L=1$, $L=2$, $L=3$, $L=4$, exact}
                \nextgroupplot[width=9cm,height=7cm,domain=0:1,xmode=linear,ymode=log, xlabel={}, ylabel={}, title={$\Vert \partial_t (u - u_h) \Vert_{L^2(0,T;L^2(\Omega))}$}, %cycle list name=paulcolors, 
                legend pos=south west, %yticklabels={,,},
                ]
                %\addplot+[discard if not={contrast}{1.0},line width=2.5pt,mark=None,color=black] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/exact_plot_data.csv};
                \addplot+[discard if not={order}{2}, discard if not={contrast}{2.5},line width=1.1pt] table [x=L, y=L2-L2-error-u_t, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_1D_jumpingCoefs_k2_WPFalse.csv};
                \addplot+[discard if not={order}{2}, discard if not={contrast}{2.5},line width=1.1pt] table [x=L, y=bestapprox-L2-L2-error-u_t, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_1D_jumpingCoefs_k2_WPFalse.csv};
                \addplot+[discard if not={order}{3}, discard if not={contrast}{2.5},line width=1.1pt] table [x=L, y=L2-L2-error-u_t, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_1D_jumpingCoefs_k3_WPFalse.csv};
                \addplot+[discard if not={order}{3}, discard if not={contrast}{2.5},line width=1.1pt] table [x=L, y=bestapprox-L2-L2-error-u_t, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_1D_jumpingCoefs_k3_WPFalse.csv};
                \addplot[gray, dashed, domain=1:4] {15*(1/2^(2))^(x-0.9)};
                \addplot[gray, dashed, domain=1:4] {7.5*(1/2^(3))^(x-0.9)};
                \node [draw=none] at (axis description cs:0.80,0.40) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{2})$};
                \node [draw=none] at (axis description cs:0.65,0.2) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{3})$};
                \legend{$k=2$,best, $k = 3$, best}
            \end{groupplot}
        \end{tikzpicture}
    \end{center}
    \caption{Approximation of \eqref{eq:1D:exact:simple} with $c_1 = 2.5$}
    \label{fig:jumpCoefs:contrast:2.5}
  \end{figure}


  \begin{figure}[!htbp]
    \begin{center}
        \begin{tikzpicture}[scale=0.72]
            \begin{groupplot}[%
                group style={%
                group size=2 by 1,
                horizontal sep=1.5cm,
                vertical sep=2cm,
                },
            ymajorgrids=true,
            grid style=dashed,
            %ymin = 1e-3, ymax = 0.5e1,
            ]    
                \nextgroupplot[width=9cm,height=7cm,domain=0:1,xmode=linear,ymode=linear, xlabel={}, ylabel={}, title={$u$ vs. $u_h$ ($k = 3$)}, %cycle list name=paulcolors, 
                legend pos=north west, %yticklabels={,,},
                ]
                %\addplot+[discard if not={contrast}{1.0},line width=2.5pt,mark=None,color=black] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/exact_plot_data.csv};
                \addplot+[discard if not={L}{1},line width=1.1pt,mark=None] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_approx_plot_data_WPFalse_contrast5.5_k3.csv};
                \addplot+[discard if not={L}{2},line width=1.1pt,mark=None] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_approx_plot_data_WPFalse_contrast5.5_k3.csv};
                \addplot+[discard if not={L}{3},line width=1.1pt,mark=None] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_approx_plot_data_WPFalse_contrast5.5_k3.csv};
                \addplot+[discard if not={contrast}{5.5},line width=1.1pt,mark=None,color=black] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/exact_plot_data_1D_simple.csv};

                \draw[dashed,gray,very thick] (0.5,-2) -- (0.5,2);
                \node [draw=none] at (axis description cs:0.45,0.23) {\color{gray} $\Gamma$};

                \legend{$L=1$, $L=2$, $L=3$}
                \nextgroupplot[width=9cm,height=7cm,domain=0:1,xmode=linear,ymode=log, xlabel={}, ylabel={}, title={$\Vert \partial_t (u - u_h) \Vert_{L^2(0,T;L^2(\Omega))}$}, %cycle list name=paulcolors, 
                legend pos=south west, %yticklabels={,,},
                ]
                %\addplot+[discard if not={contrast}{1.0},line width=2.5pt,mark=None,color=black] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/exact_plot_data.csv};
                \addplot+[discard if not={order}{2}, discard if not={contrast}{5.5},line width=1.1pt] table [x=L, y=L2-L2-error-u_t, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_1D_jumpingCoefs_k2_WPFalse_contrast5.5.csv};
                \addplot+[discard if not={order}{2}, discard if not={contrast}{5.5},line width=1.1pt] table [x=L, y=bestapprox-L2-L2-error-u_t, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_1D_jumpingCoefs_k2_WPFalse_contrast5.5.csv};
                \addplot+[discard if not={order}{3}, discard if not={contrast}{5.5},line width=1.1pt] table [x=L, y=L2-L2-error-u_t, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_1D_jumpingCoefs_k3_WPFalse_contrast5.5.csv};
                \addplot+[discard if not={order}{3}, discard if not={contrast}{5.5},line width=1.1pt] table [x=L, y=bestapprox-L2-L2-error-u_t, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/newexact_1D_jumpingCoefs_k3_WPFalse_contrast5.5.csv};
                \addplot[gray, dashed, domain=1:4] {15*(1/2^(2))^(x-0.9)};
                \addplot[gray, dashed, domain=1:4] {7.5*(1/2^(3))^(x-0.9)};
                \node [draw=none] at (axis description cs:0.80,0.40) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{2})$};
                \node [draw=none] at (axis description cs:0.65,0.2) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{3})$};
                \legend{$k=2$,best, $k = 3$, best}
            \end{groupplot}
        \end{tikzpicture}
    \end{center}
    \caption{Approximation of \eqref{eq:1D:exact:simple} with $c_1 = 5.5$}
    \label{fig:jumpCoefs:contrast:5.5}
  \end{figure}

\subsubsection{Multiple jumps}
We extend the above example to the case with multiple jumps 
\begin{equation}\label{eq:1D:exact:simpleMult}
    u(x,t) := \begin{cases}
        \cos(w_1 c_1 t) \cos(w_1(x-p_1)), & x \in \Omega_1, \\
        \cos(w_2 c_2 t) \cos(w_2(x-p_1)), & x \in \Omega_2, \\
        \cos(w_3 c_3 t) \cos(w_3(x-p_2)), & x \in \Omega_3,
    \end{cases}
\end{equation}
We choose $w_1$, $c_1$, $w_2$, and $c_2$ as above, and set $c_3 = c_1$, $w_3 = w_1$. We have to choose $p_2$ in dependence of $p_1$ such that the function is continuous, where we use that 
\begin{equation*}
    \cos(w_2(x-p_1)) = 1 \Leftrightarrow w_2(x-p_1) = 2 \pi n, n \in \mathbb{Z} \Leftrightarrow x = \frac{2 \pi n + w_2 p_1}{w_2}, n \in \mathbb{Z}. 
\end{equation*}
Thus, we choose $p_2 = \frac{2 \pi n + w_2 p_1}{w_2}$ for some $n \in \mathbb{Z}$.

\begin{figure}[!htbp]
    \begin{center}
        \begin{tikzpicture}[scale=0.72]
            \begin{groupplot}[%
                group style={%
                group size=2 by 1,
                horizontal sep=1.5cm,
                vertical sep=2cm,
                },
            ymajorgrids=true,
            grid style=dashed,
            ymin = -1.1e0, ymax = 1.1e0,
            ]    
                \nextgroupplot[width=9cm,height=7cm,domain=0:1,xmode=linear,ymode=linear, xlabel={}, ylabel={}, title={$u$}, %cycle list name=paulcolors, 
                legend pos=north west, %yticklabels={,,},
                ]
                \addplot+[line width=1.1pt,mark=None] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/exact_plot_data_1D_multipleJumps.csv};
                

                \draw[dashed,gray,very thick] (0.4,-2) -- (0.4,2);
                \draw[dashed,gray,very thick] (0.6666,-2) -- (0.6666,2);
                %\node [draw=none] at (axis description cs:0.45,0.23) {\color{gray} $\Gamma$};

                \nextgroupplot[width=9cm,height=7cm,domain=0:1,xmode=linear,ymode=linear, xlabel={}, ylabel={}, title={$u_h$ ($k = 3$)}, %cycle list name=paulcolors, 
                legend pos=north west, %yticklabels={,,},
                ]
                \draw[fill=gray!40,draw=none,opacity=0.5] (0.3,-2) -- (0.3,2) -- (0,2) -- (0,-2) -- cycle;
                \draw[fill=gray!40,draw=none,opacity=0.5] (0.7,-2) -- (0.7,2) -- (1.0,2) -- (1.0,-2) -- cycle;
                \addplot+[line width=1.1pt,mark=None] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/multipleJumps_approx_plot_data_WPFalse_contrast7.5_k3.csv};
                

                \draw[dashed,gray,very thick] (0.4,-2) -- (0.4,2);
                \draw[dashed,gray,very thick] (0.6666,-2) -- (0.6666,2);
                \node [draw=none] at (axis description cs:0.38,0.15) {\color{gray} $\Gamma_1$};
                \node [draw=none] at (axis description cs:0.6,0.15) {\color{gray} $\Gamma_2$};
                \node [draw=none] at (axis description cs:0.2,0.15) {\color{gray} $\omega$};
                \node [draw=none] at (axis description cs:0.8,0.15) {\color{gray} $\omega$};
                

            \end{groupplot}
        \end{tikzpicture}
    \end{center}
    \caption{Multiple jumps}
    \label{fig:jumpCoefs:multiple}
  \end{figure}


\subsection{2nd one dimensional example}
We consider the example from \cite{BDE22}. With $u_0 (x) := \frac{1}{100} \exp(-(20(x-\frac{1}{5}))^2)$, the exact solution is given by 
\begin{equation}
    u(x,t) = \begin{cases}
      \sum_{k \ge 0} \left( \frac{c_2-c_1}{c_2+c_1}\right)^k \left( u_0 (k + x - c_1 t) 0- u_0(k-x-c_1 t)\right), x \in \Omega_1, \\
      \left( \frac{2c_1}{c_2+c_1}\right) \sum_{k \ge 0} \left( \frac{c_2 - c_1}{c_2 + c_1}\right)^k u_0 \left( \frac{c_1}{c_2} \left( x - \frac{1}{2}\right) +k + \frac{1}{2} - c_1 t \right), x \in \Omega_2. 
    \end{cases}
\end{equation}


\subsection{Example in two space dimensions}
\subsubsection{Simple example} We extend the function defined in \eqref{eq:1D:exact:simple} to the two dimensional case by setting $u(x,y;t) = u(x;t)$, i.e. we consider the one dimensional solution in the $x$-direction. 

\begin{figure}[!htbp]
    \begin{center}
        \begin{tikzpicture}[scale=0.72]
            \begin{groupplot}[%
                group style={%
                group size=2 by 2,
                horizontal sep=1.5cm,
                vertical sep=2cm,
                },
            ymajorgrids=true,
            grid style=dashed,
            %ymin = 1e-3, ymax = 0.5e1,
            ]    
                \nextgroupplot[width=9cm,height=7cm,domain=0:4,xmode=linear,ymode=log, xlabel={}, ylabel={}, title={$c_1 = 1.0, \Vert \partial_t (u - u_h) \Vert_{L^2(0,T;L^2(\Omega))}$}, %cycle list name=paulcolors, 
                legend pos=north east, %yticklabels={,,},
                ]
                %\addplot+[discard if not={contrast}{1.0},line width=2.5pt,mark=None,color=black] table [x=x, y=y, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/exact_plot_data.csv};
                \addplot+[discard if not={order}{2},discard if not={contrast}{1.0},line width=1.1pt] table [x=L, y=L-infty-L2-error-ut, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/2D_errors_simpleRefsol_c1.0.csv};
                %\addplot+[discard if not={order}{2},discard if not={contrast}{1.0},line width=1.1pt,dotted] table [x=L, y=bestapprox-L-infty-L2-error-ut, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/2D_errors_simpleRefsol_c1.0.csv};


                \addplot+[discard if not={contrast}{1.0},line width=1.1pt] table [x=L, y=L-infty-L2-error-ut, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/2D_errors_simpleRefsol_k3.csv};
                %\addplot+[discard if not={contrast}{1.0},line width=1.1pt,dotted] table [x=L, y=bestapprox-L-infty-L2-error-ut, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/2D_errors_simpleRefsol_k3.csv};
                


                \addplot[gray, dashed, domain=1:4] {1.8*(1/2^(2))^(x-0.9)};
                \addplot[gray, dashed, domain=1:4] {0.35*(1/2^(3))^(x-0.9)};
                \node [draw=none] at (axis description cs:0.80,0.45) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{2})$};
                \node [draw=none] at (axis description cs:0.65,0.2) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{3})$};
    
                \legend{$k=2$,$k=3$}
                \nextgroupplot[width=9cm,height=7cm,domain=0:1,xmode=linear,ymode=log, xlabel={}, ylabel={}, title={$c_1 = 1.5, \Vert \partial_t (u - u_h) \Vert_{L^2(0,T;L^2(\Omega))}$}, %cycle list name=paulcolors, 
                legend pos=north east, %yticklabels={,,},
                ]
                \addplot+[discard if not={order}{2},discard if not={contrast}{1.5},line width=1.1pt] table [x=L, y=L-infty-L2-error-ut, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/2D_errors_simpleRefsol_c1.5.csv};

                \addplot+[discard if not={contrast}{1.5},line width=1.1pt] table [x=L, y=L-infty-L2-error-ut, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/2D_errors_simpleRefsol_k3.csv};

                \addplot[gray, dashed, domain=1:4] {6.5*(1/2^(2))^(x-0.9)};
                \addplot[gray, dashed, domain=1:4] {1.5*(1/2^(3))^(x-0.9)};
                \node [draw=none] at (axis description cs:0.80,0.40) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{2})$};
                \node [draw=none] at (axis description cs:0.65,0.2) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{3})$};
                \legend{$k=2$,$k = 3$}

                \nextgroupplot[width=9cm,height=7cm,domain=0:1,xmode=linear,ymode=log, xlabel={}, ylabel={}, title={$c_1 = 2.0, \Vert \partial_t (u - u_h) \Vert_{L^2(0,T;L^2(\Omega))}$}, %cycle list name=paulcolors, 
                legend pos=north east, %yticklabels={,,},
                ]
                \addplot+[discard if not={order}{2},discard if not={contrast}{2.0},line width=1.1pt] table [x=L, y=L-infty-L2-error-ut, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/2D_errors_simpleRefsol_c2.0.csv};

                \addplot+[discard if not={contrast}{2.0},line width=1.1pt] table [x=L, y=L-infty-L2-error-ut, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/2D_errors_simpleRefsol_k3.csv};

                \addplot[gray, dashed, domain=1:4] {12.5*(1/2^(2))^(x-0.9)};
                \addplot[gray, dashed, domain=1:4] {5.5*(1/2^(3))^(x-0.9)};
                \node [draw=none] at (axis description cs:0.80,0.40) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{2})$};
                \node [draw=none] at (axis description cs:0.65,0.2) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{3})$};
                \legend{$k=2$,$k = 3$}

                \nextgroupplot[width=9cm,height=7cm,domain=0:1,xmode=linear,ymode=log, xlabel={}, ylabel={}, title={$c_1 = 2.5, \Vert \partial_t (u - u_h) \Vert_{L^2(0,T;L^2(\Omega))}$}, %cycle list name=paulcolors, 
                legend pos=north east, %yticklabels={,,},
                ]
                \addplot+[discard if not={order}{2},discard if not={contrast}{2.5},line width=1.1pt] table [x=L, y=L-infty-L2-error-ut, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/2D_errors_simpleRefsol_c2.5.csv};

                \addplot+[discard if not={contrast}{2.5},line width=1.1pt] table [x=L, y=L-infty-L2-error-ut, col sep=comma] {../../wave_data_assimilation/data/jumpCoefs/2D_errors_simpleRefsol_k3.csv};

                \addplot[gray, dashed, domain=1:4] {22.5*(1/2^(2))^(x-0.9)};
                \addplot[gray, dashed, domain=1:4] {12.5*(1/2^(3))^(x-0.9)};
                \node [draw=none] at (axis description cs:0.80,0.40) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{2})$};
                \node [draw=none] at (axis description cs:0.65,0.2) {\color{gray}\footnotesize $\!\!\mathcal{O}(h^{3})$};
                \legend{$k=2$,$k = 3$}
            \end{groupplot}
        \end{tikzpicture}
    \end{center}
    \caption{Convergence of the error for the simple example in two space dimensions}
    \label{fig:2DjumpCoefs}
  \end{figure}

\bibliographystyle{alpha}
\bibliography{references}

\end{document}




 
